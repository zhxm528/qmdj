# 核心功能
- 前端页面：`/app/admin/member/consumption_transaction/page.tsx`
- 后台程序：`/app/api/admin/member/consumption_transaction/route.ts`
- 数据库表结构：`/md/database/6_member.sql`
- 配置文件： `/lib/config.ts`
## 需要执行的操作








## 已执行完毕、忽略不执行的操作
- 新增弹窗中，属性“会员”和“会员卡”需要联动，选择“会员”带出会员绑定的“会员卡”
- 新增消费记录时，根据所选的会员的会员等级的成本销售金额计算增加的会员有效日期天数，会员等级是按照31计算钱的，比如销售价格为29，则表示每31天收费29元，每天的销售金额为29除以31等于每天的单价，消费金额除以每天单价则得到增加的有效期天数，天数需要进位取整，后台打印增加的天数。
- 会员有效期是 `member_card`表中的`expired_at`字段
- 新增弹窗中，当选择“会员”后，带出显示会员所属会员等级，以及会员等级对应的销售单价和成本单价
- 新增弹窗中，输入“实付金额”时，自动计算并带出预计增加的有效期天数，同时显示有效期是哪一天

- 新增弹窗中，“实付金额”输入框失焦后再计算
- 只有在“实付金额”输入框 失去焦点（onBlur）时，才会读取当前表单中的 paid_amount，根据当前选中会员的等级售价和会员卡的有效期来计算：
- 每天单价 = sale_price / 31
- 增加天数 = ceil(paid_amount / 每天单价)
- 基准日期 = 选中卡的 expired_at，否则为今天
- 新到期日 = 基准日期 + 增加天数
- “会员等级”的提示出现了两次，只需要出现一次，显示在会员下即可

- 新增弹窗中，“实付金额”输入框失焦后，金额消失了，需要保持金额不要消失

- 增加查询条件：“会员”，使用ant design的select组件，会员下拉框，下拉框中的会员支持会员名称`full_name`模糊查询，会员下拉框的数据从`member`表中获取
- 增加查询条件：“会员卡号”，文本框输入，支持`member_card`会员卡表中的会员卡号`card_no`模糊查询
- 增加查询条件：“支付方式”，支持多选，使用ant design的select组件
- 增加查询条件：“状态”，支持多选，使用ant design的select组件
- 前端页面表格中，调整表格宽度，内容文字尽量不要换行，尤其是“会员卡号”一列
- 前端页面表格中，表头“操作”一列的宽度需要和表中的内容宽度保持一致



